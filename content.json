{"meta":{"title":"Hexo","subtitle":null,"description":null,"author":"John Doe","url":"http://yoursite.com"},"pages":[{"title":"郑林飞个人简介","date":"2018-01-28T12:06:19.000Z","updated":"2018-01-28T12:07:19.000Z","comments":true,"path":"about/index.html","permalink":"http://yoursite.com/about/index.html","excerpt":"","text":"郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介郑林飞个人简介"}],"posts":[{"title":"通过H5唤起本地app","slug":"通过H5唤起本地app","date":"2018-02-05T13:33:43.000Z","updated":"2018-02-05T14:29:05.000Z","comments":true,"path":"2018/02/05/通过H5唤起本地app/","link":"","permalink":"http://yoursite.com/2018/02/05/通过H5唤起本地app/","excerpt":"","text":"H5如何打开或者说唤起手机本地的app，有以下两种： 第一种方式： 通过在html的a标签里面的href中直接配置android端的schema，当然，如果有host其他的配置，跟在后面就可以了，android端配置和代码如下： android端配置：12345678910111213&lt;activity android:name = &quot;.MainActivity&quot;&gt; &lt;intent-filter&gt; &lt;action android:name = &quot;android.intent.action.MAIN&quot;/&gt; &lt;category android:name = &quot;android.intent.category.LAUNCHER&quot;/&gt; &lt;/intent-filter&gt; &lt;intent-filter&gt; &lt;action android:name=&quot;android.intent.action.VIEW&quot;/&gt; &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt; &lt;category android:name=&quot;android.intent.category.BROWSABLE&quot;/&gt; &lt;data android:host=&quot;jingewenku.com&quot; android:scheme=&quot;abraham&quot;/&gt; &lt;/intent-filter&gt;&lt;/activity&gt; 注：如果这个是配置在启动页要和标签并列在一起，不然运行后手机app的图标会没有；注意schema协议要小写,否则会有不能响应的异常! html代码： 123456789&lt;html&gt; &lt;head&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; &lt;title&gt;Insert title here&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;a href=&quot;abraham://jingewenku.com/?pid=1&quot;&gt;打开app&lt;/a&gt; &lt;/body&gt;&lt;/html&gt; 这里我们来看看schema拼接协议的格式： &lt; a href=”[scheme]://[host]/[path]?[query]”&gt;启动应用程序&lt; /a&gt; 各个项目含义如下所示： scheme：判别启动的App。 host：适当记述 path：传值时必须的key ※没有也可以 query：获取值的Key和Value ※没有也可以 以上就能实现打开本地的app了，当然是在app存在的情况下，否则的话没有反应。 大家可能会问上面的html代码中配置的不是android里面配置的schema协议吗？我明明没有配置pid，为什么要写这个呢？这是因为我们有些时候在唤起本地app的时候可能会向app传递一些参数，这些参数我们就可以配置在这里，我们只需要在oncreate里面获取就可以了。 代码如下： 12345Intent intent = getIntent(); Uri uri = intent.getData(); if (uri != null) &#123; String pid = uri.getQueryParameter(&quot;pid&quot;);&#125; 如果还想要获取android里面配置的schema协议的话，还可以这样: 12345678910111213141516171819202122232425Uri uri = getIntent().getData();if(uri != null) &#123; // 完整的url信息 String url = uri.toString(); Log.e(TAG, &quot;url: &quot; + uri); // scheme部分 String scheme = uri.getScheme(); Log.e(TAG, &quot;scheme: &quot; + scheme); // host部分 String host = uri.getHost(); Log.e(TAG, &quot;host: &quot; + host); //port部分 int port = uri.getPort(); Log.e(TAG, &quot;host: &quot; + port); // 访问路劲 String path = uri.getPath(); Log.e(TAG, &quot;path: &quot; + path); List&lt;String&gt; pathSegments = uri.getPathSegments(); // Query部分 String query = uri.getQuery(); Log.e(TAG, &quot;query: &quot; + query); //获取指定参数值 String goodsId = uri.getQueryParameter(&quot;goodsId&quot;); Log.e(TAG, &quot;goodsId: &quot; + goodsId);&#125; 如何判断一个Schema是否有效 : 1234567PackageManager packageManager = getPackageManager();Intent intent = newIntent(Intent.ACTION_VIEW, Uri.parse(&quot;abraham://jingewenku.com:8888/goodsDetail?goodsId=10011002&quot;));List&lt;ResolveInfo&gt; activities = packageManager.queryIntentActivities(intent, 0);booleanisValid = !activities.isEmpty();if(isValid) &#123; startActivity(intent);&#125; 这种方式也是我百度到的最多的方式，但是这样就带来了一个问题了，上面的需求说的是“在页面上有一个连接， 如果用户安装了APP，则点击打开对应的APP；如果用户没有安装，则点击打开对应的设置连接”，这明显就不符合需求了，这只能作为一些个别需求来使用了。 第二种方式： 既然通过在href配置schema协议不行，那就只能通过js代码来实现了，只有这样才能根据判断实现app有的时候就打开，没有的时候就跳转到下载链接下载。 我们知道，js是无法判断手机是否安装了某款app的，所以我们只能够曲线救国了，我们可以获取时间如果，长时间不能呼起app则默认为没有安装这款app，然后跳转到下载页。当然这不是我想出来的，是网上的各位大佬的想法。在这里又要细分为两种情况了。 1.直接唤醒 说明：通过h5可换醒app，如访问一个URL，点击按钮，打开应用，如果该应用APP没有安装，那么直接跳转到App Store的APP下载页面，通过点击的方式兼容性较好，如果安装了app，在手机各大浏览器(360浏览器、uc浏览器、搜狗浏览器、QQ浏览器、百度浏览器 )和QQ客户端中，能唤醒。微信、新浪微博客户端、腾讯微博客户端无法唤醒。 代码如下： 1234567891011121314151617181920212223242526272829303132333435&lt;html xmlns=http://www.w3.org/1999/xhtml&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type content=&quot;text/html;charset=utf-8&quot;&gt;&lt;head&gt;&lt;script src=&quot;http://libs.baidu.com/jquery/1.9.0/jquery.js&quot;&gt;&lt;/script&gt;&lt;title&gt;点击唤醒demo&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;style&gt;#zjmobliestart&#123;font-size:40px;&#125;&lt;/style&gt;&lt;!--说明：通过h5可换醒app，如访问一个URL，点击按钮，打开应用，如果该应用APP没有安装，那么直接跳转到App Store的APP下载页面，通过点击的方式。兼容性较好，如果安装了app，在手机各大浏览器(360浏览器 uc浏览器 搜狗浏览器 QQ浏览器 百度浏览器 )和QQ客户端中，能唤醒。微信 新浪微博客户端 腾讯微博客户端无法唤醒。--&gt;&lt;a href=&quot;zjmobile://platformapi/startapp&quot; id=&quot;zjmobliestart&quot; target=&quot;_blank&quot;&gt;唤醒浙江移动手机营业厅！&lt;/a&gt;&lt;script type=&quot;text/javascript&quot;&gt; function applink()&#123; return function()&#123; var clickedAt = +new Date; setTimeout(function()&#123; !window.document.webkitHidden &amp;&amp; setTimeout(function()&#123; if (+new Date - clickedAt &lt; 2000)&#123; window.location = &apos;https://itunes.apple.com/us/app/zhe-jiang-yi-dong-shou-ji/id898243566#weixin.qq.com&apos;; &#125; &#125;, 500); &#125;, 500) &#125;; &#125; document.getElementById(&quot;zjmobliestart&quot;).onclick = applink(); &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; 2.点击唤醒 说明：通过h5可换醒app，如访问一个URL就能直接打开应用，如果该应用APP没有安装，那么直接跳转到App Store的APP下载页面。兼容性一般：在手机各大浏览器(360浏览器、uc浏览器、搜狗浏览器 QQ浏览器、百度浏览器 )能唤醒。微信、QQ客户端、新浪微博客户端、 腾讯微博客户端无法唤醒。 代码如下： 1234567891011121314151617181920212223242526272829303132&lt;!Doctype html&gt;&lt;html xmlns=http://www.w3.org/1999/xhtml&gt;&lt;head&gt;&lt;meta http-equiv=Content-Type content=&quot;text/html;charset=utf-8&quot;&gt;&lt;head&gt;&lt;script src=&quot;http://libs.baidu.com/jquery/1.9.0/jquery.js&quot;&gt;&lt;/script&gt;&lt;title&gt;直接唤醒demo&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;style&gt;#zjmobliestart&#123;font-size:40px;&#125;&lt;/style&gt;&lt;!--说明：通过h5可换醒app，如访问一个URL就能直接打开应用，如果该应用APP没有安装，那么直接跳转到App Store的APP下载页面兼容性一般：在手机各大浏览器(360浏览器 uc浏览器 搜狗浏览器 QQ浏览器 百度浏览器 )能唤醒。微信 QQ客户端 新浪微博客户端 腾讯微博客户端无法唤醒。--&gt;&lt;p id=&quot;zjmobliestart&quot;&gt;唤醒浙江移动手机营业厅！&lt;/p&gt;&lt;script type=&quot;text/javascript&quot;&gt; function applink()&#123; window.location = &apos;zjmobile://platformapi/startapp&apos;; var clickedAt = +new Date; setTimeout(function()&#123; !window.document.webkitHidden &amp;&amp; setTimeout(function()&#123; if (+new Date - clickedAt &lt; 2000)&#123; window.location = &apos;https://itunes.apple.com/us/app/zhe-jiang-yi-dong-shou-ji/id898243566#weixin.qq.com&apos;; &#125; &#125;, 500); &#125;, 500) &#125;applink();&lt;/script&gt; &lt;/body&gt;&lt;/html&gt; 这样就完成了我们的需求了。 还要注意的是，如果是在微信中唤起本地app，手机的微信中，是利用微信内置的浏览器打开那个简单的HTML页面，注意：直接打开scheme://host/datastring是不可行的，微信不会把这串字符解析成网址，必须包装成网页才能借助微信的浏览器打开。进入后就是我们刚刚设计的页面。这个时候，直接点击“启动应用程序”是不会唤醒之前安装的APP的，因为微信做了屏蔽，你需要在右上角的菜单中选择“在浏览器中打开”。这个时候就可以唤醒你想唤醒的app了。","categories":[],"tags":[{"name":"其他","slug":"其他","permalink":"http://yoursite.com/tags/其他/"}]}]}